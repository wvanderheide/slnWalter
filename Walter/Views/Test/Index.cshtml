@using System.Collections;
@using Walter.ViewModels;
@model VMForecast
@{
    ViewBag.Title = "Test";

    ArrayList HiddenRowIds = new ArrayList();
    string RowId = "";
}

<h2>Learning Partial Views</h2>

<br />
<div>
    @for (int i = 1; i < 13; i++)
    {
        HiddenRowIds.Clear();

        <div class="well well-sm" style="margin-top: 20px;margin-bottom: 0px" onclick="$('#Div@(i)_@(Model.ForecastYearId)').slideDown('slow');">
            @MonthName(i, 2016)
        </div>
        <div id="Div@(i)_@(Model.ForecastYearId)" style="display: none;">
            <table>
                <tr>
                    <th style="padding: 10px">-/+</th>
                    <th>ProductID</th>
                    <th style="padding: 10px">ProductName</th>
                    <th>Forecast</th>
                </tr>
                @foreach (var p in Model.AllProducts)
                {
                    var rowItem = new VMphoto();
                    var RDForecastThisItem = Model.RdForecast.Where(t => t.Title == p.Title).ToList();

                    if (RDForecastThisItem.Count == 0)
                    {
                        RowId = "Row_" + Model.ForecastYearId.ToString() + "_" + i.ToString() + "_" + p.Id.ToString();
                        HiddenRowIds.Add(RowId);
                        @Row(RowId, p);
                    }
                    else
                    {
                        var temp = RDForecastThisItem[0];
                        RowId = "Row_" + Model.ForecastYearId.ToString() + "_" + i.ToString() + "_" + temp.Id.ToString();
                        if (temp.Day == 0)
                        {

                        }

                        @Row(RowId, temp);
                    }
                }
            </table>

            @foreach (var id in HiddenRowIds)
            {
                <span onclick="$('#@id').show()">@id</span> @:|
            }
        </div>
    }
</div>
@* -----------------------------------------------------------------------------
       Helper Methods
    ------------------------------------------------------------------------------- *@
@helper MonthName(int month, int year)
{
    DateTime dtDate = new DateTime(year, month, 1);
    string monthNameShort = dtDate.ToString("MMM");
    string monthName = dtDate.ToString("MMMM");

    @monthName @year
}

@helper Row(string RowId, VMphoto item)
{
    string display = "";

    if (item.Day == 0)
    {
        display = "style=display:none;";
    }
    <tr id="@RowId" @display>
        <td style="padding: 10px" onclick="$('#@RowId').hide();">-/+</td>
        <td>@item.Id</td>
        <td style="padding: 10px">@item.Title</td>
        <td>@item.Day</td>
    </tr>
}