@model Walter.ViewModels.VmElmahErrors
@{
	ViewBag.Title = "Elmah";
	int totalErrors = 0;
}

Unique Errors: <span class="badge">@Model.Errors.Count</span>
<table class="table table-striped">
	<thead>
	<tr>
		<th>Type</th>
		<th>Message</th>
		<th>Count</th>
		<th>Newest</th>
		<th>Oldest</th>
	</tr>
	</thead>
	<tbody>
	@foreach (var err in Model.Errors)
	{
		totalErrors += @err.Count;
		<tr>
            <td><span title="@err.Type">@TypeShortened(err.Type)</span></td>
			<td style="max-width: 300px"><a href="@Url.Action("Detail", "ErrorLog")?showErrors=10&MaxSequence=@err.MaxSequence&count=@err.Count&msg=@err.Message">@err.Message</a></td>
			<td>@err.Count</td>
			<td>@err.Newest</td>
			<td>@err.Oldest</td>
		</tr>
	}
	</tbody>
</table>
Total Errors: <span class="badge">@totalErrors</span>
<br/>
<br/>
The Table above was generated from the SQL below:
<br/>
<textarea rows="4" cols="100">@Model.Sql</textarea>

<br/>
<br/>
<b>Hints</b>
<ul>
	<li>Generate a test exception: http://toolbox.klasresearch.com/elmah.axd/test</li>
    <li>MVC Generate a test exception: http://walter/elmah/test</li>
	<li>Error log: http://wvander-toolbox/elmah.axd </li>
    <li>MVC Error log: http://walter/elmah </li>
</ul>
@* -----------------------------------------------------------------------------
	   Helper Methods
	------------------------------------------------------------------------------- *@
@helper TypeShortened(string fullType)
{
	string[] parts = fullType.Split('.');
	fullType = parts[parts.Length - 1];
	fullType = fullType.Replace("Exception", "");
	if (fullType.Length == 0)
	{
		fullType = parts[parts.Length - 1];
	}
	
	@fullType;
}
